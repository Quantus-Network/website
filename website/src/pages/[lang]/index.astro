---
import Layout from "@/components/layout/Layout.astro";
import HeroBanner from "@/components/features/home/hero-banner/HeroBanner.astro";
import IntroductionVideo from "@/components/features/home/introduction-video/IntroductionVideo.astro";
import Benefits from "@/components/features/home/benefits/Benefits.astro";
import Teams from "@/components/features/home/teams/Teams.astro";
import Roadmap from "@/components/features/home/roadmap/Roadmap.astro";
import Events from "@/components/features/home/events/Events.astro";
import AppDownload from "@/components/features/home/app-download/AppDownload.astro";
import Socials from "@/components/ui/Socials.astro";
import env from "@/config";

import {
  getLocaleFromUrl,
  getLocalizedMetadata,
  SUPPORTED_LOCALES,
} from "@/utils/i18n";
import type { SEOProps } from "astro-seo";
import defaultMetadata from "@/constants/default-metadata";
import { JsonLdGraph } from "@/utils/build-json-ld";

export async function getStaticPaths() {
  return SUPPORTED_LOCALES.map((lang) => ({ params: { lang } }));
}

const locale = getLocaleFromUrl(Astro.url.pathname);
const localizedMetadata = await getLocalizedMetadata(locale);

const metadata: SEOProps = {
  ...localizedMetadata,
  canonical: `${env.SITE_BASE_URL}/${locale}`,
};

const jsonLd = JsonLdGraph({
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebSite",
      name: localizedMetadata.title,
      url: env.SITE_BASE_URL,
      image: {
        "@type": "ImageObject",
        name: defaultMetadata.openGraph?.image?.alt ?? "",
        contentUrl: defaultMetadata.openGraph?.image?.url as string,
      },
      description: localizedMetadata.description,
      sameAs: [
        "https://www.linkedin.com/company/quantus-network",
        "https://x.com/QuantusNetwork",
        "https://www.instagram.com/quantusnetwork",
        "https://www.youtube.com/@Quantus.Network",
        "https://github.com/Quantus-Network",
      ],
      potentialAction: {
        "@type": "SubscribeAction",
        description:
          "Subscribe to our Newsletter. Alpha Alert! Get your weekly news-blast with sneak previews, updates, news roundup, educational content and more",
        target: {
          "@type": "EntryPoint",
          urlTemplate: `${env.SITE_BASE_URL}/#footer`,
          actionPlatform: [
            "http://schema.org/DesktopWebPlatform",
            "http://schema.org/IOSPlatform",
            "http://schema.org/AndroidPlatform",
          ],
        },
      },
    },
    {
      "@id": env.SITE_BASE_URL,
      "@type": "Organization",
    },
  ],
});
---

<Layout {...metadata} jsonLd={jsonLd}>
  <HeroBanner />
  <IntroductionVideo />
  <Benefits />
  <AppDownload />
  <Teams />
  <Roadmap />
  <Events />
  <Socials />
</Layout>
