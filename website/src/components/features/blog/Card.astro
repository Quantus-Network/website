---
import Tag from "@/components/ui/Tag.astro";
import { getLocaleFromUrl, getLocalizedPath } from "@/utils/i18n";

interface Props {
  title: string;
  description: string;
  pubDate: Date;
  href: string;
  tags?: string[];
  heroImage?: string;
}

const { title, description, pubDate, href, tags = [], heroImage } = Astro.props;

const currentLocale = getLocaleFromUrl(Astro.url.pathname);

const formattedDate = pubDate.toLocaleDateString(currentLocale, {
  year: "numeric",
  month: "short",
  day: "numeric",
});
---

<div
  class="group flex flex-col gap-4 rounded-lg border border-white/10 p-4 transition-colors hover:bg-white/5"
>
  <a href={href} class="block">
    {
      heroImage && (
        <div class="mb-4 aspect-video w-full overflow-hidden rounded-md">
          <img
            src={heroImage}
            alt={title}
            class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
          />
        </div>
      )
    }
    <div class="mb-2 flex items-center justify-between">
      <time datetime={pubDate.toISOString()} class="text-sm text-gray-400">
        {formattedDate}
      </time>
    </div>
    <h3 class="group-hover:text-primary mb-2 text-xl font-bold text-white">
      {title}
    </h3>
    <p class="text-gray-300">
      {description}
    </p>
  </a>
  {
    tags.length > 0 && (
      <div class="mt-auto flex flex-wrap gap-2">
        {tags.map((tag) => (
          <Tag>
            <a
              href={getLocalizedPath(currentLocale, `/blog/tags/${tag}`)}
              class="hover:text-primary transition-colors"
            >
              {tag}
            </a>
          </Tag>
        ))}
      </div>
    )
  }
</div>
